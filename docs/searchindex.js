Search.setIndex({"docnames": ["index", "reference/application_notes", "reference/custom_kscan/index", "reference/dnx/index", "reference/getting_started", "reference/kbchost/index", "reference/kscan/index", "reference/modules", "reference/overview", "reference/peripheral/index", "reference/porting_ecfw_custom_hw/index", "reference/power_sequencing/index", "reference/smc/index", "reference/soc_debug_awareness/index", "reference/supported_hw", "reference/task_handling/index"], "filenames": ["index.rst", "reference/application_notes.rst", "reference/custom_kscan/index.rst", "reference/dnx/index.rst", "reference/getting_started.rst", "reference/kbchost/index.rst", "reference/kscan/index.rst", "reference/modules.rst", "reference/overview.rst", "reference/peripheral/index.rst", "reference/porting_ecfw_custom_hw/index.rst", "reference/power_sequencing/index.rst", "reference/smc/index.rst", "reference/soc_debug_awareness/index.rst", "reference/supported_hw.rst", "reference/task_handling/index.rst"], "titles": ["Embedded controller firmware documentation", "EC FW application notes", "Add custom keyboard matrix", "EC support for Intel Download and Execute", "Getting started", "Keyboard System Controller Host", "Keyboard scan matrix", "EC FW application modules", "Project overview", "Peripheral management", "Port Basic EC FW to custom HW design", "Power Sequencing", "System Management Controller", "EC support for Intel SoC Debug", "Supported Hardware", "Task Handling"], "terms": {"welcom": 0, "project": [0, 2, 4, 10], "": [0, 4, 8, 10, 13, 14], "The": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "provid": [0, 2, 3, 6, 8, 10, 11, 13, 14], "under": [0, 4, 10, 12], "apach": 0, "2": [0, 2, 6, 8, 11, 12, 13, 14, 15], "0": [0, 3, 4, 12, 14], "licens": 0, "found": 0, "file": [0, 4, 8, 10], "github": [0, 4], "repo": [0, 4, 8, 10], "intel": [0, 1, 2, 4, 7, 8, 10, 12, 14, 15], "ec": [0, 2, 6, 8, 9, 11, 14, 15], "fw": [0, 6, 8, 11, 12, 13, 14, 15], "framework": [0, 10, 12, 15], "refer": [0, 1, 2, 3, 4, 8, 10, 11, 12, 13, 14], "code": [0, 1, 2, 3, 5, 6, 8, 11, 12, 13, 15], "intend": [0, 5, 10], "prototyp": 0, "evalu": [0, 3, 10, 13, 14], "home": [0, 9, 14], "overview": 0, "get": [0, 3, 5, 13], "start": [0, 3], "support": [0, 1, 2, 4, 7, 8, 11, 12, 15], "hardwar": [0, 4, 8, 9, 10, 11], "applic": [0, 2, 3, 4, 6, 8, 11, 13, 14, 15], "modul": [0, 2, 4, 5, 6, 9, 10, 11, 12, 13, 15], "note": [0, 2, 3, 4, 10, 12, 13], "embed": [1, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "control": [1, 2, 6, 7, 8, 9, 10, 11, 13, 14, 15], "firmwar": [1, 3, 8, 10, 11, 15], "allow": [1, 2, 3, 4, 5, 10, 12, 13, 14, 15], "differ": [1, 2, 3, 5, 9, 10, 11, 12, 13, 14, 15], "extens": 1, "These": [1, 4, 5, 6, 10, 11, 12], "ar": [1, 2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 15], "disabl": [1, 3, 5, 9, 10, 13, 15], "default": [1, 2, 3, 5, 9, 10, 13, 15], "most": [1, 3, 9, 10, 12, 14], "case": [1, 3, 4, 5, 9, 10, 11, 13, 15], "each": [1, 2, 4, 7, 8, 10, 11, 12, 15], "document": [1, 3, 4, 13], "its": [1, 3, 4, 5, 10, 12, 15], "respect": [1, 8, 9, 11], "includ": [1, 2, 4, 10, 11, 12, 15], "main": [1, 3, 7, 8, 9, 11, 12, 14], "flow": [1, 3, 5, 6, 7, 13], "implement": [1, 5, 7, 13, 14], "detail": [1, 2, 4, 6, 7, 10, 12, 13, 14], "configur": [1, 2, 3, 5, 6, 7, 9, 13, 14, 15], "option": [1, 7], "soc": [1, 3, 8, 11, 12, 14], "debug": [1, 3, 14], "add": [1, 7, 10, 14], "custom": [1, 8], "keyboard": [1, 3, 7, 8, 10, 14, 15], "matrix": [1, 3, 5, 7, 8, 10, 14, 15], "port": [1, 3, 5, 12, 14], "basic": [1, 8, 14], "hw": [1, 2, 3, 4, 5, 11, 13], "design": [1, 3, 5, 8, 11, 13, 14, 15], "thi": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "describ": [2, 3, 5, 7, 9, 10, 11, 12, 13, 15], "requir": [2, 4, 5, 8, 10, 11, 13, 14, 15], "us": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "do": [2, 3, 11, 12], "supported_hw": 2, "rst": 2, "current": [2, 4, 7, 10, 13], "fujitsu": [2, 14], "can": [2, 3, 4, 5, 6, 8, 10, 11, 12, 13, 14, 15], "connect": [2, 3, 6, 9, 11, 12, 13, 14], "mecc": [2, 4, 13], "card": [2, 4, 6], "tigerlak": [2, 14], "rvp": [2, 3, 4, 10, 11, 13, 14], "meanwhil": 2, "gtech": [2, 6], "adl": 2, "p": [2, 4, 6, 8, 10, 14, 15], "scan": [2, 5, 7, 13, 14], "state": [2, 3, 5, 6, 9, 11, 13], "data": [2, 3, 5, 6, 12], "repres": [2, 6], "an": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 15], "depend": [2, 6, 10, 15], "host": [2, 3, 4, 6, 7, 10, 11, 12, 15], "receiv": [2, 3, 5, 6, 11, 12], "command": [2, 3, 4, 5, 6, 10], "send": [2, 3, 5, 6, 11], "event": [2, 6, 9, 11, 12], "back": [2, 3, 5, 6, 9, 11], "similarli": [2, 10, 12], "underli": [2, 6], "zephyr": [2, 5, 6, 8, 10, 13, 15], "driver": [2, 5, 6, 9, 13], "perform": [2, 3, 4, 5, 6, 8, 11, 12, 13, 15], "indic": [2, 3, 4, 5, 9, 10, 11, 12, 13, 14], "rto": [2, 4, 8, 10, 15], "track": [2, 6, 9, 11, 12], "which": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 15], "still": [2, 3, 6], "press": [2, 3, 5, 6, 9, 11, 12, 13], "ones": [2, 6, 10], "being": [2, 6, 14], "releas": [2, 4, 5, 6, 9], "relai": [2, 6], "kscan": [2, 6], "form": [2, 3, 6, 11, 12], "callback": [2, 6, 9, 12, 13], "onc": [2, 3, 5, 6, 9, 10, 11, 13], "translat": [2, 6], "grid": [2, 5, 6], "coordin": [2, 6], "queue": [2, 6], "them": [2, 4, 5, 6, 9], "same": [2, 3, 4, 6, 10, 11, 12, 13, 15], "see": [2, 4, 5, 6, 10, 11, 12, 15], "imag": [2, 3, 5, 6], "below": [2, 4, 5, 6, 8, 10, 12, 13, 14], "more": [2, 4, 5, 6, 7, 10, 12, 14], "section": [2, 4, 7, 9, 11, 12, 15], "specif": [2, 3, 10, 12, 14], "step": [2, 4], "instruct": 2, "board": [2, 3, 4, 6, 8, 9, 11, 13, 14, 15], "It": [2, 3, 4, 9, 13], "cover": [2, 3, 8, 11, 13], "introduc": 2, "vendor": [2, 3, 10, 14], "well": [2, 3, 8, 13, 15], "defin": [2, 5, 10, 11, 12, 13, 14, 15], "everi": [2, 5, 9], "must": [2, 3, 8, 10, 13], "api": [2, 15], "kbs_keymap": 2, "h": [2, 10, 12], "instanti": 2, "done": [2, 3, 10, 15], "through": [2, 3, 4, 5, 12, 14], "factori": 2, "function": [2, 5, 7, 8], "so": [2, 3, 4, 6, 8, 10, 11, 12, 13, 15], "inlin": 2, "struct": 2, "km_api": 2, "keymap_init_interfac": 2, "void": 2, "config_ec_gtech_keyboard": 2, "return": [2, 5], "gtech_init": 2, "elif": 2, "config_ec_fujitsu_keyboard": 2, "fujitsu_init": 2, "els": 2, "null": 2, "endif": [2, 13], "shall": [2, 3, 13], "hierarchi": 2, "organ": 2, "wai": 2, "choos": [2, 15], "between": [2, 4, 11, 12, 15], "sever": [2, 4, 12], "brand": 2, "interact": [2, 3, 5, 8, 9, 10, 12, 15], "menu": [2, 3, 5], "desir": [2, 3, 5, 10], "choic": 2, "prompt": 2, "select": 2, "your": [2, 4, 9, 10, 11], "ec_gtech_keyboard": 2, "help": 2, "go": [2, 3, 4, 5], "you": [2, 8], "handl": [2, 3, 5, 7, 8, 9, 11, 12], "variat": [2, 5, 14], "special": [2, 3, 13], "altern": [2, 3, 4, 5, 13], "config": 2, "bool": 2, "ec_fujitsu_keyboard": 2, "config_kscan_ec": 2, "OR": 2, "config_ps2_keyboard_and_mous": 2, "target_sourc": 2, "app": [2, 10], "privat": 2, "cmake_current_list_dir": 2, "gtech_keymap": 2, "c": [2, 3, 4, 10], "fujitsu_keymap": 2, "arrai": [2, 15], "fill": 2, "like": [2, 4, 5, 8], "invert": 2, "simplifi": 2, "read": [2, 5, 12, 14], "8": 2, "ksi": 2, "expos": [2, 3], "pointer": 2, "get_keynum": 2, "also": [2, 3, 5, 6, 8, 9, 10, 11, 12], "when": [2, 5, 6, 10, 12, 13, 14, 15], "need": [2, 3, 4, 5, 10, 11, 12, 14], "assign": 2, "get_fnkei": 2, "gener": [2, 4, 5, 10, 11, 14], "sci": 2, "smc": [2, 10, 12], "all": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12], "set": [2, 3, 5, 6, 9, 10, 13], "end": [2, 14], "user": [2, 4, 5, 11], "decid": 2, "behavior": [2, 5], "exampl": [2, 5, 10], "f6": 2, "print": 2, "screen": [2, 9], "By": [2, 3, 15], "type": [2, 5], "scan_cod": 2, "typemat": [2, 5], "fals": 2, "offici": [2, 4], "ha": [2, 3, 4, 5, 6, 9, 12, 13, 14], "final": [2, 5, 8, 13], "consid": [2, 3, 9, 11], "unmap": 2, "sc_unmap": 2, "could": [2, 3, 10, 13, 15], "There": [2, 5, 6, 11, 12, 14], "impact": 2, "differenti": 2, "explicitli": [2, 15], "identifi": [2, 3], "error": [2, 4, 11], "have": [2, 5, 10, 13, 15], "break": 2, "singl": 2, "byte": [2, 5, 6, 12], "In": [2, 3, 5, 6, 8, 12, 13, 15], "possibl": [2, 4, 15], "combin": [2, 5, 8, 13], "limit": [2, 3, 4, 10], "top": 2, "arrow": 2, "role": [3, 8, 9, 11, 13], "valid": [3, 11, 14], "avail": [3, 4, 5, 10, 13, 14, 15], "deriv": 3, "capabl": [3, 8, 11], "wherein": 3, "cse": 3, "compon": [3, 6], "usb": [3, 14], "devic": [3, 5, 8, 9], "content": 3, "from": [3, 4, 5, 9, 11, 12, 14, 15], "machin": 3, "unit": 3, "verifi": [3, 14], "write": [3, 5, 12], "spi": [3, 4], "emmc": 3, "primari": 3, "purpos": [3, 5], "initi": [3, 4, 6, 9, 12], "updat": [3, 4, 13], "downgrad": 3, "provis": 3, "system": [3, 6, 7, 8, 9, 13, 15], "recov": 3, "detect": [3, 4, 5, 12, 13], "corrupt": 3, "virgin": 3, "token": [3, 13], "inject": 3, "For": [3, 4, 5, 10, 11, 13, 14], "addit": [3, 4, 8, 9, 10, 11, 13], "mechan": [3, 5, 9, 13, 15], "after": [3, 5, 9, 10, 11, 13], "gain": 3, "handshak": [3, 11], "mode": [3, 10], "earlier": [3, 11], "plai": 3, "put": 3, "where": [3, 5, 9, 10, 11, 12, 13], "via": [3, 4, 5, 10, 11, 15], "connector": [3, 6, 14], "longer": 3, "newer": 3, "architectur": [3, 12], "As": [3, 10, 12, 13, 14], "dure": [3, 4, 9, 10, 11, 13], "transit": [3, 5, 9, 13, 15], "resum": [3, 13], "hibern": [3, 13], "shutdown": [3, 13], "check": [3, 4, 11, 12, 13], "certain": [3, 11, 13], "condit": [3, 5, 11, 13], "met": [3, 11, 13], "ani": [3, 5, 6, 9, 10, 11, 12, 13, 15], "fulfil": [3, 11, 13], "within": [3, 5, 9, 10, 11, 12, 13], "predetermin": [3, 11, 13], "time": [3, 5, 9, 10, 11, 13, 15], "interv": [3, 11, 13], "power": [3, 5, 7, 8, 9, 10, 13, 14, 15], "sequenc": [3, 7, 8, 10, 12, 13, 14, 15], "stop": [3, 11, 13], "intention": [3, 13], "earli": [3, 5, 13], "stage": [3, 13], "enter": [3, 11], "becom": [3, 12, 13, 15], "should": [3, 4, 10, 12, 13, 15], "avoid": [3, 13], "disrupt": [3, 13], "e": [3, 4, 10, 12, 13], "shut": 3, "down": [3, 9], "If": [3, 4, 5, 9, 10, 11, 13, 15], "espi": [3, 8, 10, 11, 12], "showcas": [3, 8, 14], "strap": [3, 5, 13], "doe": [3, 10, 12, 15], "jumper": [3, 13], "directli": [3, 14], "up": [3, 9, 11, 13], "g3": [3, 14], "exit": [3, 11], "scenario": [3, 11, 12], "alon": 3, "satisfi": 3, "said": 3, "intercept": [3, 5], "dnx_force_relad": 3, "base": [3, 4, 8, 10, 11, 13], "pre": [3, 5, 11, 15], "determin": [3, 5, 6, 11, 15], "action": [3, 5, 11, 13, 15], "peripher": [3, 7, 8, 10, 11, 12, 15], "hold": 3, "volum": [3, 9, 14], "multipl": [3, 4, 7, 12, 15], "kei": [3, 5, 6, 13], "hotkei": [3, 7], "etc": [3, 8, 10], "some": [3, 4, 5, 11, 14, 15], "constraint": [3, 13], "master": [3, 4], "attach": [3, 5, 13], "flash": [3, 10], "sampl": [3, 5, 13], "rsmrst": 3, "signal": [3, 10, 14], "de": [3, 11], "assert": [3, 11], "rom": 3, "bootload": 3, "prevent": [3, 13, 15], "prior": [3, 5, 11, 13], "part": [3, 4, 10], "factor": [3, 13], "physic": [3, 11, 12, 13], "difficult": 3, "remot": 3, "session": 3, "reason": 3, "scalabl": 3, "method": [3, 10, 12, 13], "while": [3, 4, 5, 12], "alreadi": [3, 4, 9, 10, 11, 13], "s0": [3, 13], "sinc": [3, 4, 5, 6, 10, 15], "activ": [3, 4], "bio": [3, 8, 10, 12, 15], "propag": [3, 11], "efi": [3, 5], "blank": 3, "yet": [3, 10], "been": [3, 4, 5, 6, 14], "program": 3, "automat": 3, "viewpoint": 3, "recover": 3, "failur": [3, 11], "howev": [3, 5, 10, 11, 13, 14], "cannot": [3, 6, 14], "warn": [3, 12], "virtual": [3, 11, 12], "wire": [3, 5, 6, 11, 12], "reset": [3, 5, 8, 9, 11, 12, 13, 15], "follow": [3, 4, 7, 10, 11, 12, 13], "soft": 3, "whenev": [3, 9, 11, 12, 13], "global": [3, 11], "occur": [3, 9], "manual": 3, "cycl": [3, 13], "onli": [3, 4, 5, 8, 9, 10, 12, 13], "enabl": [3, 4, 5, 8, 9, 10, 12, 15], "kconfig": [3, 5, 10, 15], "cfg": 3, "recommend": [3, 4, 13], "saf": [3, 14], "ye": [3, 13, 14], "No": [3, 13, 14], "commun": [3, 5, 12, 13], "intent": [3, 13], "csme": 3, "wait": [3, 5, 11, 12], "restart": 3, "platform": [3, 8, 10, 12, 13, 14, 15], "ifwi": 3, "sent": [3, 6, 12], "soon": [3, 13], "slave": 3, "retriev": [3, 4], "upon": [3, 12, 13], "vw": 3, "access": 3, "ack": [3, 5], "4": [3, 14], "usual": [3, 10], "mai": [3, 4, 5, 14], "abov": [3, 4, 8, 10, 11, 12, 14], "flag": [3, 10, 12, 13], "later": [3, 4, 6], "usag": [3, 5], "achiev": [3, 15], "pin": [3, 9, 10, 11, 12, 13, 14], "high": [3, 9, 13, 15], "reli": [3, 11], "pseudo": [3, 14], "batteri": [3, 8, 11, 12, 15], "insert": [3, 11], "level": [3, 8, 9, 12], "shell": [3, 4, 5], "s5": 3, "button": [3, 12, 13, 14, 15], "pch_pwrok": [3, 10, 11], "ec_ds3": 3, "logic": [3, 5, 10], "dpwrok": 3, "re": [3, 4, 13], "enumer": [3, 10], "seen": 3, "volatil": [3, 13], "save": [3, 11, 13], "persist": 3, "across": [3, 13], "gpio": [3, 9, 11], "mention": [3, 12], "instead": [3, 4, 11, 13, 14], "request": [3, 5, 12], "over": [3, 9, 11, 12], "notif": [3, 5, 11, 13], "clear": [3, 13], "v": 3, "coexist": [3, 4], "dedic": 3, "ensur": [3, 4, 10, 13], "driven": [3, 9], "circuitri": [3, 11], "permit": [3, 15], "open": [3, 4, 8, 9, 10, 14], "drain": [3, 10], "output": [3, 5, 10, 11], "fetch": 3, "bu": [3, 11, 12], "channel": [3, 12], "handov": 3, "first": [3, 13, 15], "abl": [3, 14], "addition": [3, 9, 14], "acknowledg": [3, 11], "develop": 4, "account": 4, "ubuntu": 4, "18": 4, "04": 4, "lt": 4, "window": [4, 5, 11, 13], "work": 4, "vpn": 4, "intranet": 4, "compani": 4, "proxi": 4, "correctli": 4, "line": [4, 9, 13], "tool": [4, 8, 13], "apt": 4, "wget": 4, "pip": 4, "git": 4, "guid": [4, 5, 10, 11, 14], "review": 4, "consider": 4, "latest": [4, 10], "sourc": [4, 8, 10, 11, 14], "v3": 4, "16": 4, "simpler": [4, 15], "mandatori": 4, "present": [4, 10], "uninstal": 4, "third": [4, 12], "parti": [4, 8], "7": [4, 11, 15], "copi": [4, 10], "kernel": [4, 15], "version": [4, 8], "dediprog": 4, "A": [4, 6, 10, 12], "compil": [4, 5, 10], "contain": [4, 8, 10], "microchip": [4, 10], "mec15xx": [4, 14], "mec172x": [4, 14], "arm": [4, 10], "microcontrol": [4, 8, 12], "gnu": 4, "eabi": 4, "evb": 4, "root": [4, 10], "folder": 4, "mec": 4, "creat": [4, 13], "sandbox": 4, "ecfw": [4, 10], "mkdir": 4, "cd": 4, "http": [4, 5, 10], "com": [4, 5], "navig": 4, "west": [4, 8], "manifest": [4, 8], "locat": [4, 10], "insid": 4, "init": 4, "l": [4, 10], "list": [4, 8, 10, 13], "destin": [4, 5], "revis": [4, 8, 14], "extern": [4, 8, 13], "zephyr_fork": 4, "zephyrproject": [4, 10], "cmsi": 4, "hal": [4, 8, 10], "74981bf": 4, "hal_microchip": 4, "5d079f1": 4, "directori": [4, 10], "structur": 4, "look": 4, "____ecfw": 4, "____ecfwwork": 4, "snapshot": 4, "patch": 4, "out": [4, 9, 10, 11, 15], "henc": [4, 5, 9, 13], "branch": 4, "expect": [4, 5], "futur": [4, 5, 7], "thei": [4, 5, 6, 10], "integr": 4, "assum": [4, 9, 11], "checkout": 4, "ecfwwork": 4, "am": 4, "zephyr_patch": 4, "patches_v3": 4, "throw": 4, "mean": [4, 6, 8, 9], "previou": [4, 5, 11], "safe": 4, "delet": 4, "backup": 4, "exist": [4, 13], "other": [4, 5, 9, 10, 11, 12, 13, 15], "problem": 4, "run": [4, 5, 6, 10, 11, 13], "path": 4, "env": 4, "sh": 4, "tree": 4, "zephyr_bas": 4, "script": 4, "switch": [4, 14], "mtl": [4, 10, 14], "arl": 4, "auto": 4, "b": [4, 10, 11], "mec172x_mtl_": 4, "mec1501_mtl_p": [4, 10], "tgl": [4, 6, 11, 13], "deprec": [4, 14], "alwai": [4, 13], "mec1501modular_assy6885": 4, "dconfig_mec15xx_aic_on_tgl": 4, "y": [4, 13], "mec172xmodular_assy6930": 4, "similar": 4, "replac": 4, "modular": [4, 6, 14], "success": 4, "bin": 4, "ksc": [4, 5, 6], "spi_imag": 4, "give": 4, "make": [4, 15], "sure": 4, "execut": [4, 7, 11, 15], "printenv": 4, "grep": 4, "revisit": 4, "spi_gen": 4, "confirm": 4, "usr": 4, "local": 4, "everglades_spi_gen_lin64": 4, "chmod": 4, "x": [4, 13], "wa": [5, 11], "conceiv": 5, "realiz": [5, 6], "8042": 5, "spec": [5, 11, 14], "ibm": 5, "1": [5, 12, 13, 14], "core": 5, "inform": [5, 6, 8, 12], "cpu": [5, 10, 14, 15], "manag": [5, 7, 10, 15], "auxiliari": 5, "kept": 5, "evolv": 5, "point": 5, "respons": [5, 11, 12], "than": [5, 13], "just": 5, "therefor": [5, 9], "todai": 5, "becam": 5, "subset": [5, 8], "chip": [5, 10], "modern": 5, "pc": [5, 8], "either": [5, 9, 10, 11, 12, 15], "pictur": 5, "illustr": [5, 6], "trigger": [5, 9, 11], "here": [5, 11], "we": [5, 6, 7, 10], "softwar": [5, 7], "entiti": 5, "show": 5, "how": [5, 12, 15], "process": [5, 9, 12, 13], "mainli": [5, 9], "fsm": 5, "direct": [5, 9, 10, 11, 12], "3": [5, 14], "isr": [5, 12], "precis": 5, "moment": 5, "0x60": 5, "default_st": 5, "new": [5, 11], "order": [5, 8, 9], "continu": [5, 6, 9], "given": 5, "kbchost": [5, 6], "two": 5, "thread": [5, 9, 11, 12, 13, 15], "input": [5, 9, 10, 13], "valu": [5, 12], "One": 5, "exclus": 5, "feed": 5, "argument": 5, "dummi": 5, "result": [5, 9], "exercis": [5, 10], "becaus": 5, "artifici": 5, "repli": 5, "maintain": 5, "remain": [5, 13], "speak": 5, "0x64": 5, "term": 5, "arriv": 5, "address": [5, 12, 14], "payload": 5, "On": [5, 9, 10, 12], "hand": [5, 10, 12], "wish": 5, "both": [5, 9, 10, 12, 14], "transact": [5, 12], "complet": [5, 6, 11], "goe": 5, "context": [5, 12], "0xd4": 5, "0xf4": 5, "0xfa": 5, "0xad": 5, "0xa7": 5, "0xaa": 5, "self": 5, "test": [5, 10], "0x55": 5, "0x67": 5, "0xed": 5, "led": 5, "0x00": 5, "turn": [5, 11], "off": [5, 11], "wherea": 5, "bear": 5, "mind": 5, "vari": 5, "drive": [5, 11], "littl": 5, "complex": 5, "finer": 5, "calibr": 5, "dictat": 5, "0x02": 5, "correspond": [5, 10], "bit": 5, "one": [5, 10, 12], "0x20": 5, "0x77": 5, "0xae": 5, "0xa8": 5, "0x44": 5, "0x74": 5, "0xff": 5, "bat": 5, "0x04": 5, "0x34": 5, "0xf3": 5, "rate": 5, "delai": [5, 11], "id": 5, "0x47": 5, "0xf2": 5, "0xe8": 5, "resolut": 5, "0xe6": 5, "scale": 5, "0xe9": 5, "statu": [5, 11, 12], "0x03": 5, "0xc8": 5, "0x50": 5, "0x08": 5, "reus": 5, "intern": [5, 13], "leav": 5, "undisrupt": 5, "featur": [5, 13, 14], "runtim": [5, 12], "chang": [5, 9, 13], "timeout": 5, "reduc": [5, 11, 14], "modifi": [5, 10, 12], "eas": 5, "distinct": 5, "come": [5, 11], "50m": 5, "definit": 5, "guarante": 5, "race": [5, 13], "64bito": 5, "tistori": 5, "cfile29": 5, "uf": 5, "02784b4d50f966f12c3160": 5, "pdf": 5, "compos": [6, 15], "row": 6, "column": 6, "circuit": [6, 9], "close": [6, 9, 13], "eventu": 6, "sens": 6, "map": [6, 11, 14], "treat": 6, "were": 6, "few": 6, "fake": 6, "want": 6, "let": 6, "successfulli": 6, "involv": [6, 9], "isn": 6, "t": [6, 9], "ribbon": 6, "bottom": 6, "divid": 7, "plan": [7, 14, 15], "task": [7, 8, 11, 12], "download": 7, "variou": 8, "low": [8, 9, 11], "oper": [8, 12, 13], "thermal": [8, 10, 12, 14, 15], "lan": 8, "pcie": 8, "ia": [8, 13], "oem": [8, 13], "leverag": 8, "boot": [8, 10, 13, 15], "enhanc": [8, 11], "serial": [8, 11, 14], "interfac": [8, 9, 11, 14, 15], "demonstr": 8, "3rd": 8, "common": [8, 12], "depict": [8, 12], "packag": [8, 10], "bsp": [8, 10], "abstract": [8, 10], "layer": [8, 10], "meta": 8, "yml": 8, "act": [8, 12], "find": 8, "about": [8, 12, 13, 14], "human": [9, 12, 14, 15], "associ": 9, "pull": [9, 11, 13], "interrupt": [9, 12], "laptop": [9, 11], "lid": [9, 14], "rotat": 9, "lock": 9, "notifi": [9, 12], "deal": 9, "undesir": 9, "effect": 9, "bang": 9, "togeth": 9, "caus": 9, "electr": 9, "rebound": 9, "befor": [9, 10, 11, 12, 13, 15], "settl": 9, "transient": 9, "remov": [9, 11], "debounc": [9, 11], "cooper": [9, 11, 12, 15], "regist": [9, 11, 12, 13], "per": [9, 10, 12], "edg": 9, "move": 9, "stabl": [9, 11], "counter": 9, "begin": 9, "increas": 9, "millisecond": 9, "reach": 9, "zero": 9, "without": [9, 13], "bounc": 9, "period": [9, 12, 15], "observ": 9, "expir": 9, "anoth": 9, "maximum": 9, "debounce_tim": 9, "won": 9, "exhibit": 9, "durat": 9, "exceed": 9, "5": 9, "too": 9, "noisi": 9, "filter": 9, "actual": [9, 10], "adapt": [10, 14], "link": 10, "major": 10, "ITE": 10, "nuvoton": 10, "realtek": 10, "even": [10, 15], "minimum": [10, 15], "uart": [10, 14], "timer": 10, "i2c": 10, "80": [10, 14], "visual": 10, "acpi": [10, 14], "taf": 10, "share": [10, 12], "trust": 10, "non": [10, 13, 15], "critic": [10, 15], "keyscan": [10, 13], "advanc": 10, "fan": [10, 11, 12, 14], "peci": 10, "tach": 10, "adc": 10, "pwm": 10, "model": 10, "least": 10, "repositori": 10, "mani": 10, "standalon": 10, "g": 10, "frequenc": 10, "particular": 10, "relev": [10, 11, 12], "o": [10, 11, 12], "among": 10, "famili": 10, "overlai": 10, "closest": 10, "meteor": 10, "lake": 10, "mobil": 10, "take": [10, 14, 15], "To": [10, 11, 12, 14], "out_of_tree_board": 10, "dt": 10, "lj": 10, "guidelinesprovid": 10, "doc": 10, "org": 10, "board_port": 10, "html": 10, "friendli": 10, "macro": 10, "i2c_bus_0": 10, "dt_nodelabel": 10, "i2c_smb_0": 10, "boardname_chipvers": 10, "ec_gpio_106": 10, "ec_gpio_036": 10, "ec_gpio_xxx": 10, "number": 10, "flexibl": [10, 13], "appli": [10, 11], "overal": [10, 11], "unwant": 10, "readi": [10, 15], "pars": 10, "load": [10, 13], "mec1501_mtl_p_defconfig": 10, "merg": 10, "prj": 10, "conf": [10, 13], "aforement": 10, "ad": [10, 14], "built": 10, "fix": 10, "keep": 11, "desktop": 11, "concept": 11, "enough": 11, "known": 11, "smc_onoff": 11, "toward": [11, 12], "pch": [11, 15], "good": 11, "rail": 11, "slp_s3": 11, "slp_s4": 11, "slp_s5": 11, "undergo": 11, "specifi": 11, "transmit": [11, 12], "gx": 11, "whole": 11, "visibl": 11, "rsmrst_pwrgd": 11, "sus_wrn": 11, "sus_ack": 11, "capac": 11, "pm_batlow": 11, "slp_m": 11, "sometim": 11, "slp_a": 11, "sys_pwrok": 11, "segment": [11, 15], "displai": [11, 15], "post": [11, 15], "ac": 11, "adaptor": 11, "reconfigur": 11, "consumpt": [11, 13], "further": 11, "lose": 11, "entri": 11, "ec_dsx": 11, "pm_slp_su": 11, "wake": 11, "rmsrst": 11, "sus_warn": 11, "regular": 11, "normal": [11, 13], "10": 11, "m": [11, 14], "again": [11, 12, 15], "hub": 11, "did": 11, "Such": 11, "postcod": [11, 15], "format": 11, "ecnn": 11, "nn": 11, "aspect": 11, "smbu": 12, "memori": [12, 13], "chapter": 12, "12": 12, "queri": [12, 13], "obtain": 12, "domain": 12, "Or": 12, "extend": 12, "bidirect": 12, "vice": 12, "versa": 12, "figur": 12, "70": 12, "rang": 12, "ec_sc": 12, "written": 12, "ec_dat": 12, "exchang": 12, "frequent": 12, "emul": 12, "tunnel": 12, "lpc": 12, "11": 12, "nutshel": 12, "predefin": [12, 13], "0x80": 12, "0x84": 12, "0x66": 12, "0x62": 12, "traffic": 12, "ibf": 12, "free": 12, "66": 12, "outgo": 12, "3a": 12, "until": 12, "3b": 12, "62": 12, "4a": 12, "obf": 12, "incom": 12, "4b": 12, "previous": 12, "awar": 12, "issu": 12, "upcom": 12, "outsid": 12, "pattern": 12, "schedul": [12, 15], "asynchron": 12, "enqueu": 12, "implic": 12, "flush": 12, "standard": 12, "own": 12, "space": 12, "nevertheless": [12, 13], "instanc": 12, "tabl": [12, 14], "match": 12, "field": 12, "enrich": 12, "smchost_cod": 12, "odm": 13, "wdt": 13, "cabl": 13, "authent": 13, "collect": 13, "extract": 13, "emerg": 13, "trace": 13, "crash": 13, "log": [13, 14], "manufactur": 13, "floor": 13, "bone": 13, "pile": 13, "triag": 13, "rma": 13, "appropri": 13, "product": 13, "chassi": 13, "perturb": 13, "pmc_gpio": 13, "At": 13, "attent": 13, "paid": 13, "loop": 13, "next": 13, "amount": [13, 15], "prefer": 13, "pmc": 13, "prj_mec1501modular_assy6885": 13, "config_early_key_sequence_detect": 13, "config_power_sequence_disable_timeout_hotkei": 13, "config_early_keyseq_custom0": 13, "33": 13, "item": 13, "hot": 13, "occurr": 13, "second": [13, 15], "last": 13, "alt": 13, "shift": 13, "d": 13, "ifdef": 13, "pwreq_timeout_dis": 13, "kbs_keyseq_boot_detect": 13, "keyseq_timeout": 13, "pwrseq_timeout_dis": 13, "true": 13, "log_wrn": 13, "kb": 13, "constrain": 13, "6": 13, "conjunct": 14, "advantag": 14, "guidelin": [14, 15], "rework": 14, "u": 14, "mec152x": 14, "alderak": 14, "raptorlak": 14, "Not": 14, "meteorlak": 14, "lunarlak": 14, "pantherlak": 14, "npcx4": 14, "ite8002": 14, "onboard": 14, "rout": 14, "miss": 14, "compar": 14, "schemat": 14, "discuss": 14, "adher": 14, "consist": 14, "guidanc": 14, "what": 14, "area": 14, "sx": 14, "deep": 14, "sleep": [14, 15], "dsx": 14, "temperatur": 14, "ps2": 14, "mous": [14, 15], "porta": 14, "portb": 14, "though": 14, "1x5": 14, "header": 14, "mec17xx": 14, "spawn": 15, "essenti": 15, "creation": 15, "idiom": 15, "static": 15, "less": 15, "k_thread_defin": 15, "dynam": 15, "approach": 15, "termin": 15, "middl": 15, "perspect": 15, "multicor": 15, "slice": 15, "algorithm": 15, "multitask": 15, "preemptiv": 15, "voluntarili": 15, "relinquish": 15, "yield": 15, "offer": 15, "prioriti": 15, "never": 15, "unreadi": 15, "starvat": 15, "simplic": 15, "accord": 15}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"embed": 0, "control": [0, 3, 5, 12], "firmwar": 0, "document": 0, "ec": [1, 3, 4, 5, 7, 10, 12, 13], "fw": [1, 3, 4, 7, 10], "applic": [1, 7, 9, 10], "note": 1, "add": 2, "custom": [2, 10, 12, 14], "keyboard": [2, 5, 6, 13], "matrix": [2, 6, 13], "introduct": [2, 6], "overview": [2, 3, 8, 10, 13, 15], "how": 2, "implement": [2, 3, 6, 9, 11, 12, 15], "new": [2, 10], "ad": 2, "build": [2, 4, 10], "system": [2, 5, 11, 12], "map": [2, 10], "row": 2, "column": 2, "ibm": 2, "kei": 2, "number": 2, "fn": 2, "fx": 2, "ani": 2, "support": [3, 9, 10, 13, 14], "intel": [3, 11, 13], "download": 3, "execut": [3, 5], "dnx": 3, "function": 3, "requir": 3, "1": [3, 4, 10], "awar": [3, 13], "timeout": [3, 11, 13], "2": [3, 4, 5, 10], "user": 3, "trigger": 3, "assist": 3, "entri": 3, "3": [3, 4, 10], "non": 3, "detail": 3, "relat": 3, "option": [3, 13], "featur": [3, 10], "other": 3, "consider": [3, 13], "maf": 3, "boot": 3, "when": [3, 9], "dnx_force_reload": 3, "get": 4, "start": 4, "pre": 4, "requisit": 4, "set": 4, "up": 4, "zephyr": 4, "environ": 4, "o": [4, 5], "select": 4, "instal": 4, "depend": [4, 8], "python": 4, "4": 4, "sdk": 4, "toolchain": 4, "5": 4, "soc": [4, 10, 13], "vendor": 4, "specif": [4, 11], "setup": 4, "framework": 4, "code": 4, "clone": 4, "main": 4, "repositori": [4, 8], "obtain": 4, "appli": 4, "back": 4, "port": [4, 10], "fix": 4, "troubleshoot": 4, "flash": 4, "variabl": 4, "host": 5, "theori": 5, "oper": 5, "p": 5, "initi": 5, "sequenc": [5, 11], "bio": 5, "mous": 5, "hotkei": [5, 13], "refer": 5, "scan": 6, "modul": 7, "project": 8, "manag": [8, 9, 11, 12], "peripher": 9, "window": 9, "button": [9, 11], "switch": 9, "basic": 10, "hw": [10, 12, 14], "design": 10, "architectur": 10, "board": 10, "guidelin": 10, "creat": 10, "devic": 10, "tree": 10, "folder": 10, "mecc": [10, 14], "card": [10, 14], "driver": 10, "gpio": [10, 13], "configur": 10, "overrid": 10, "verifi": 10, "power": 11, "signal": 11, "input": 11, "rsmrst": 11, "_pwrgd": 11, "all_sys_pwrgd": 11, "slp_sx": 11, "transit": 11, "acpi": [11, 12], "flow": [11, 12], "g3": 11, "s0": 11, "s3": 11, "suspend": 11, "resum": 11, "s4": 11, "s5": 11, "hibern": 11, "shutdown": 11, "deep": 11, "sleep": 11, "mechan": [11, 12], "variant": 11, "across": 11, "platform": 11, "interfac": 12, "sw": 12, "queue": 12, "sci": 12, "notif": 12, "region": 12, "command": 12, "debug": 13, "while": 13, "i": 13, "enabl": 13, "consent": 13, "via": 13, "bootstal": 13, "extens": 13, "hardwar": 14, "limit": 14, "task": 15, "handl": 15}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Embedded controller firmware documentation": [[0, "embedded-controller-firmware-documentation"]], "EC FW application notes": [[1, "ec-fw-application-notes"]], "Add custom keyboard matrix": [[2, "add-custom-keyboard-matrix"]], "Introduction": [[2, "introduction"], [6, "introduction"]], "Overview": [[2, "overview"], [10, "overview"], [13, "overview"], [15, "overview"]], "How to implement a new keyboard": [[2, "how-to-implement-a-new-keyboard"]], "Adding a new keyboard to the build system": [[2, "adding-a-new-keyboard-to-the-build-system"]], "Map row/column to IBM key numbers": [[2, "map-row-column-to-ibm-key-numbers"]], "Map FN + FX or FN + Any key": [[2, "map-fn-fx-or-fn-any-key"]], "EC support for Intel Download and Execute": [[3, "ec-support-for-intel-download-and-execute"]], "DnX overview": [[3, "dnx-overview"]], "EC functional requirements for DnX": [[3, "ec-functional-requirements-for-dnx"]], "1. EC DnX awareness and EC timeout": [[3, "ec-dnx-awareness-and-ec-timeout"]], "2. User-triggered EC-assisted DnX entry": [[3, "user-triggered-ec-assisted-dnx-entry"]], "3. Non-user triggered DnX entry": [[3, "non-user-triggered-dnx-entry"]], "Implementation details": [[3, "implementation-details"]], "EC FW DnX awareness": [[3, "ec-fw-dnx-awareness"]], "EC FW DnX-related optional features": [[3, "ec-fw-dnx-related-optional-features"]], "Other considerations": [[3, "other-considerations"]], "Supporting MAF boot when controlling DNX_FORCE_RELOAD": [[3, "supporting-maf-boot-when-controlling-dnx-force-reload"]], "Getting started": [[4, "getting-started"]], "Pre-requisites": [[4, "pre-requisites"]], "Setting Up Zephyr environment": [[4, "setting-up-zephyr-environment"]], "1) OS selection": [[4, "os-selection"]], "2) Install dependencies": [[4, "install-dependencies"]], "3) Get Zephyr and Python dependencies": [[4, "get-zephyr-and-python-dependencies"]], "4) Install Zephyr SDK and toolchain": [[4, "install-zephyr-sdk-and-toolchain"]], "5) EC SoC vendor-specific setup": [[4, "ec-soc-vendor-specific-setup"]], "Getting EC FW framework code": [[4, "getting-ec-fw-framework-code"]], "1) Clone main repository": [[4, "clone-main-repository"]], "2) Obtain the dependencies": [[4, "obtain-the-dependencies"]], "3) Apply back-ported fixes": [[4, "apply-back-ported-fixes"]], "Troubleshoot": [[4, "troubleshoot"], [4, "id2"]], "Building and flashing": [[4, "building-and-flashing"]], "1) Set zephyr environment variables": [[4, "set-zephyr-environment-variables"]], "2) Build EC FW": [[4, "build-ec-fw"]], "Flash EC FW": [[4, "flash-ec-fw"]], "Keyboard System Controller Host": [[5, "keyboard-system-controller-host"]], "Theory of operation": [[5, "theory-of-operation"]], "PS/2 keyboard initialization sequence executed in BIOS": [[5, "ps-2-keyboard-initialization-sequence-executed-in-bios"]], "PS/2 keyboard and mouse initialization sequence executed in OS": [[5, "ps-2-keyboard-and-mouse-initialization-sequence-executed-in-os"]], "EC hotkeys": [[5, "ec-hotkeys"]], "References": [[5, "references"]], "Keyboard scan matrix": [[6, "keyboard-scan-matrix"]], "Implementation": [[6, "implementation"], [9, "implementation"], [11, "implementation"], [12, "implementation"], [15, "implementation"]], "EC FW application modules": [[7, "ec-fw-application-modules"]], "Project overview": [[8, "project-overview"]], "Dependencies": [[8, "dependencies"]], "Repository Management": [[8, "repository-management"]], "Peripheral management": [[9, "peripheral-management"]], "Windows Button Support": [[9, "windows-button-support"]], "Switches (when applicable)": [[9, "switches-when-applicable"]], "Port Basic EC FW to custom HW design": [[10, "port-basic-ec-fw-to-custom-hw-design"]], "EC SoC and architecture": [[10, "ec-soc-and-architecture"]], "Board support": [[10, "board-support"]], "EC porting guidelines": [[10, "ec-porting-guidelines"]], "1. Create device tree board folder": [[10, "create-device-tree-board-folder"]], "MECC cards": [[10, "mecc-cards"]], "Custom HW": [[10, "custom-hw"], [14, "custom-hw"]], "2. Customize EC FW for a board": [[10, "customize-ec-fw-for-a-board"]], "2.1 Map EC SoC drivers to application features": [[10, "map-ec-soc-drivers-to-application-features"]], "2.2 Create EC GPIO mapping": [[10, "create-ec-gpio-mapping"]], "2.3 Create EC board configuration override": [[10, "create-ec-board-configuration-override"]], "3. Verify EC FW build for new board": [[10, "verify-ec-fw-build-for-new-board"]], "Power Sequencing": [[11, "power-sequencing"]], "Power Signals": [[11, "power-signals"]], "Power button input": [[11, "power-button-input"]], "RSMRST#_PWRGD": [[11, "rsmrst-pwrgd"]], "ALL_SYS_PWRGD": [[11, "all-sys-pwrgd"]], "SLP_Sx#": [[11, "slp-sx"]], "System transitions": [[11, "system-transitions"]], "ACPI System Transitions": [[11, "acpi-system-transitions"]], "Flow for G3 to S0": [[11, "flow-for-g3-to-s0"]], "Flow for S0 to S3 (suspend)": [[11, "flow-for-s0-to-s3-suspend"]], "Flow for S3 to S0 (resume)": [[11, "flow-for-s3-to-s0-resume"]], "Flow for S0 to S4/S5 (hibernate/shutdown)": [[11, "flow-for-s0-to-s4-s5-hibernate-shutdown"]], "Flow for S5/S4 to S0": [[11, "flow-for-s5-s4-to-s0"]], "Intel-specific Power Management Transitions": [[11, "intel-specific-power-management-transitions"]], "Flow for S3/S4/S5 to deep sleep": [[11, "flow-for-s3-s4-s5-to-deep-sleep"]], "Flow for deep sleep to S3/S4/S5": [[11, "flow-for-deep-sleep-to-s3-s4-s5"]], "Timeout Mechanism": [[11, "timeout-mechanism"]], "Variants Across Platforms": [[11, "variants-across-platforms"]], "System Management Controller": [[12, "system-management-controller"]], "HW interface": [[12, "hw-interface"]], "SW flow": [[12, "sw-flow"]], "Queue Mechanism": [[12, "queue-mechanism"]], "SCI Notifications": [[12, "sci-notifications"]], "ACPI Region": [[12, "acpi-region"]], "Custom EC Commands": [[12, "custom-ec-commands"]], "EC support for Intel SoC Debug": [[13, "ec-support-for-intel-soc-debug"]], "SoC debug while EC timeout is enabled": [[13, "soc-debug-while-ec-timeout-is-enabled"]], "EC SoC-debug awareness": [[13, "ec-soc-debug-awareness"]], "SoC-debug consent via SoC bootstall GPIO": [[13, "soc-debug-consent-via-soc-bootstall-gpio"]], "Considerations": [[13, "considerations"], [13, "id1"]], "Optional extensions": [[13, "optional-extensions"]], "SoC-debug consent via Keyboard matrix hotkey": [[13, "soc-debug-consent-via-keyboard-matrix-hotkey"]], "Supported Hardware": [[14, "supported-hardware"]], "MECC card HW limitations": [[14, "mecc-card-hw-limitations"]], "Task Handling": [[15, "task-handling"]]}, "indexentries": {}})