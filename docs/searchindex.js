Search.setIndex({"docnames": ["index", "reference/application_notes", "reference/custom_kscan/index", "reference/dnx/index", "reference/getting_started", "reference/kbchost/index", "reference/kscan/index", "reference/modules", "reference/overview", "reference/peripheral/index", "reference/power_sequencing/index", "reference/smc/index", "reference/soc_debug_awareness/index", "reference/supported_hw", "reference/task_handling/index"], "filenames": ["index.rst", "reference/application_notes.rst", "reference/custom_kscan/index.rst", "reference/dnx/index.rst", "reference/getting_started.rst", "reference/kbchost/index.rst", "reference/kscan/index.rst", "reference/modules.rst", "reference/overview.rst", "reference/peripheral/index.rst", "reference/power_sequencing/index.rst", "reference/smc/index.rst", "reference/soc_debug_awareness/index.rst", "reference/supported_hw.rst", "reference/task_handling/index.rst"], "titles": ["Embedded controller firmware documentation", "EC FW application notes", "Add custom keyboard matrix", "EC support for Intel Download and Execute", "Getting started", "Keyboard System Controller Host", "Keyboard scan matrix", "EC FW application modules", "Overview", "Peripheral management", "Power Sequencing", "System Management Controller", "EC support for Intel SoC Debug", "Supported Hardware", "Task Handling"], "terms": {"welcom": 0, "project": [0, 2, 4, 8], "": [0, 4, 8, 12, 13], "The": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14], "provid": [0, 2, 3, 6, 8, 10, 12, 13], "under": [0, 4, 11, 13], "apach": 0, "2": [0, 2, 6, 8, 10, 11, 12, 13, 14], "0": [0, 3, 4, 11], "licens": 0, "found": 0, "file": [0, 4, 8], "github": [0, 4], "repo": [0, 4, 8], "intel": [0, 1, 2, 4, 7, 8, 11, 13, 14], "ec": [0, 2, 6, 8, 9, 10, 14], "fw": [0, 6, 8, 10, 11, 12, 14], "framework": [0, 11, 14], "refer": [0, 1, 2, 3, 4, 8, 10, 11, 12, 13], "code": [0, 1, 2, 3, 5, 6, 8, 10, 11, 12, 14], "intend": [0, 5, 13], "prototyp": 0, "evalu": [0, 3, 12, 13], "home": [0, 9, 13], "overview": 0, "get": [0, 3, 5, 12], "start": [0, 3], "support": [0, 1, 2, 4, 7, 8, 10, 11, 14], "hardwar": [0, 4, 8, 9, 10], "applic": [0, 2, 3, 4, 6, 8, 10, 12, 13, 14], "modul": [0, 2, 4, 5, 6, 9, 10, 11, 12, 13, 14], "note": [0, 2, 3, 4, 11, 12], "embed": [1, 5, 6, 7, 8, 9, 10, 11, 13, 14], "control": [1, 2, 6, 7, 8, 9, 10, 12, 13, 14], "firmwar": [1, 3, 8, 10, 14], "allow": [1, 2, 3, 4, 5, 11, 12, 13, 14], "differ": [1, 2, 3, 5, 9, 10, 11, 12, 13, 14], "extens": 1, "These": [1, 4, 5, 6, 10, 11, 13], "ar": [1, 2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14], "disabl": [1, 3, 5, 9, 12, 14], "default": [1, 2, 3, 5, 9, 12, 14], "most": [1, 3, 9, 11, 13], "case": [1, 3, 4, 5, 9, 10, 12, 14], "each": [1, 2, 4, 7, 8, 10, 11, 14], "document": [1, 3, 4, 12], "its": [1, 3, 4, 5, 11, 13, 14], "respect": [1, 8, 9, 10], "includ": [1, 2, 4, 10, 11, 14], "main": [1, 3, 7, 8, 9, 10, 11, 13], "flow": [1, 3, 5, 6, 7, 12], "implement": [1, 5, 7, 12, 13], "detail": [1, 2, 4, 6, 7, 11, 12, 13], "configur": [1, 2, 3, 5, 6, 7, 9, 12, 13, 14], "option": [1, 7], "soc": [1, 3, 8, 10, 11], "debug": [1, 3, 13], "add": [1, 7, 13], "custom": [1, 8], "keyboard": [1, 3, 7, 8, 13, 14], "matrix": [1, 3, 5, 7, 8, 13, 14], "thi": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14], "describ": [2, 3, 5, 7, 9, 10, 11, 12, 13, 14], "requir": [2, 4, 5, 8, 10, 12, 13, 14], "us": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14], "do": [2, 3, 10, 11], "hw": [2, 3, 4, 5, 10, 12], "supported_hw": 2, "rst": 2, "current": [2, 4, 7, 12, 13], "fujitsu": [2, 13], "can": [2, 3, 4, 5, 6, 8, 10, 11, 12, 13, 14], "connect": [2, 3, 6, 9, 10, 11, 12, 13], "mecc": [2, 4, 12, 13], "card": [2, 4, 6, 13], "tigerlak": 2, "rvp": [2, 3, 4, 10, 12, 13], "meanwhil": 2, "gtech": [2, 6], "adl": 2, "p": [2, 4, 6, 8, 13, 14], "scan": [2, 5, 7, 12, 13], "state": [2, 3, 5, 6, 9, 10, 12], "data": [2, 3, 5, 6, 11], "repres": [2, 6], "an": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14], "depend": [2, 6, 14], "host": [2, 3, 4, 6, 7, 10, 11, 13, 14], "receiv": [2, 3, 5, 6, 10, 11], "command": [2, 3, 4, 5, 6], "send": [2, 3, 5, 6, 10], "event": [2, 6, 9, 10, 11], "back": [2, 3, 5, 6, 9, 10], "similarli": [2, 11, 13], "underli": [2, 6], "zephyr": [2, 5, 6, 8, 12, 13, 14], "driver": [2, 5, 6, 9, 12, 13], "perform": [2, 3, 4, 5, 6, 8, 10, 11, 12, 14], "indic": [2, 3, 4, 5, 9, 10, 11, 12, 13], "rto": [2, 4, 8, 13, 14], "track": [2, 6, 9, 10, 11], "which": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14], "still": [2, 3, 6], "press": [2, 3, 5, 6, 9, 10, 11, 12], "ones": [2, 6, 13], "being": [2, 6, 13], "releas": [2, 4, 5, 6, 9], "relai": [2, 6], "kscan": [2, 6], "form": [2, 3, 6, 10, 11], "callback": [2, 6, 9, 11, 12], "onc": [2, 3, 5, 6, 9, 10, 12], "translat": [2, 6], "grid": [2, 5, 6], "coordin": [2, 6], "queue": [2, 6], "them": [2, 4, 5, 6, 9], "same": [2, 3, 4, 6, 10, 11, 12, 14], "see": [2, 4, 5, 6, 10, 11, 13, 14], "imag": [2, 3, 5, 6], "below": [2, 4, 5, 6, 8, 11, 12, 13], "more": [2, 4, 5, 6, 7, 11, 13], "section": [2, 4, 7, 9, 10, 11, 14], "specif": [2, 3, 11, 13], "step": [2, 4], "instruct": 2, "board": [2, 3, 4, 6, 8, 9, 10, 12, 13, 14], "It": [2, 3, 4, 9, 12], "cover": [2, 3, 8, 10, 12], "introduc": 2, "vendor": [2, 3, 13], "well": [2, 3, 8, 12, 14], "defin": [2, 5, 10, 11, 12, 13, 14], "everi": [2, 5, 9], "must": [2, 3, 8, 12], "api": [2, 14], "kbs_keymap": 2, "h": [2, 11, 13], "instanti": 2, "done": [2, 3, 14], "through": [2, 3, 4, 5, 11, 13], "factori": 2, "function": [2, 5, 7, 8], "so": [2, 3, 4, 6, 8, 10, 11, 12, 13, 14], "inlin": 2, "struct": 2, "km_api": 2, "keymap_init_interfac": 2, "void": 2, "config_ec_gtech_keyboard": 2, "return": [2, 5], "gtech_init": 2, "elif": 2, "config_ec_fujitsu_keyboard": 2, "fujitsu_init": 2, "els": 2, "null": 2, "endif": [2, 12], "shall": [2, 3, 12], "hierarchi": 2, "organ": 2, "wai": 2, "choos": [2, 14], "between": [2, 4, 10, 11, 14], "sever": [2, 4, 11], "brand": 2, "interact": [2, 3, 5, 8, 9, 11, 13, 14], "menu": [2, 3, 5], "desir": [2, 3, 5], "choic": 2, "prompt": 2, "select": 2, "your": [2, 4, 9, 10], "ec_gtech_keyboard": 2, "help": 2, "go": [2, 3, 4, 5], "you": [2, 8], "handl": [2, 3, 5, 7, 8, 9, 10, 11], "variat": [2, 5, 13], "special": [2, 3, 12], "altern": [2, 3, 4, 5, 12], "config": 2, "bool": 2, "ec_fujitsu_keyboard": 2, "config_kscan_ec": 2, "OR": 2, "config_ps2_keyboard_and_mous": 2, "target_sourc": 2, "app": [2, 13], "privat": 2, "cmake_current_list_dir": 2, "gtech_keymap": 2, "c": [2, 3, 4, 13], "fujitsu_keymap": 2, "arrai": [2, 14], "fill": 2, "like": [2, 4, 5, 8], "invert": 2, "simplifi": 2, "read": [2, 5, 11, 13], "8": 2, "ksi": 2, "expos": [2, 3], "pointer": 2, "get_keynum": 2, "also": [2, 3, 5, 6, 8, 9, 10, 11], "when": [2, 5, 6, 11, 12, 13, 14], "need": [2, 3, 4, 5, 10, 11, 13], "assign": 2, "get_fnkei": 2, "gener": [2, 4, 5, 10, 13], "sci": 2, "smc": [2, 11, 13], "all": [2, 3, 4, 5, 6, 8, 9, 10, 11, 13], "set": [2, 3, 5, 6, 9, 12], "end": [2, 13], "user": [2, 4, 5, 10], "decid": 2, "behavior": [2, 5], "exampl": [2, 5], "f6": 2, "print": 2, "screen": [2, 9], "By": [2, 3, 14], "type": [2, 5], "scan_cod": 2, "typemat": [2, 5], "fals": 2, "offici": [2, 4], "ha": [2, 3, 4, 5, 6, 9, 11, 12, 13], "final": [2, 5, 8, 12], "consid": [2, 3, 9, 10], "unmap": 2, "sc_unmap": 2, "could": [2, 3, 12, 14], "There": [2, 5, 6, 10, 11, 13], "impact": 2, "differenti": 2, "explicitli": [2, 14], "identifi": [2, 3], "error": [2, 4, 10], "have": [2, 5, 12, 14], "break": 2, "singl": 2, "byte": [2, 5, 6, 11], "In": [2, 3, 5, 6, 8, 11, 12, 13, 14], "possibl": [2, 4, 14], "combin": [2, 5, 8, 12], "limit": [2, 3, 4], "top": 2, "arrow": 2, "role": [3, 8, 9, 10, 12], "valid": [3, 10, 13], "avail": [3, 4, 5, 12, 13, 14], "deriv": 3, "design": [3, 5, 8, 10, 12, 13, 14], "capabl": [3, 8, 10], "wherein": 3, "cse": 3, "compon": [3, 6], "usb": [3, 13], "port": [3, 5, 11, 13], "devic": [3, 5, 8, 9, 13], "content": 3, "from": [3, 4, 5, 9, 10, 11, 13, 14], "machin": 3, "unit": 3, "verifi": [3, 13], "write": [3, 5, 11], "spi": [3, 4], "emmc": 3, "primari": 3, "purpos": [3, 5], "initi": [3, 4, 6, 9, 11], "updat": [3, 4, 12], "downgrad": 3, "provis": 3, "system": [3, 6, 7, 8, 9, 12, 14], "recov": 3, "detect": [3, 4, 5, 11, 12], "corrupt": 3, "virgin": 3, "token": [3, 12], "inject": 3, "For": [3, 4, 5, 10, 12, 13], "addit": [3, 4, 8, 9, 10, 12], "mechan": [3, 5, 9, 12, 14], "after": [3, 5, 9, 10, 12], "gain": 3, "handshak": [3, 10], "mode": 3, "earlier": [3, 10], "plai": 3, "put": 3, "where": [3, 5, 9, 10, 11, 12, 13], "via": [3, 4, 5, 10, 13, 14], "connector": [3, 6, 13], "longer": 3, "newer": 3, "architectur": [3, 11], "As": [3, 11, 12, 13], "dure": [3, 4, 9, 10, 12], "transit": [3, 5, 9, 12, 14], "resum": [3, 12], "hibern": [3, 12], "shutdown": [3, 12], "check": [3, 4, 10, 11, 12], "certain": [3, 10, 12], "condit": [3, 5, 10, 12], "met": [3, 10, 12], "ani": [3, 5, 6, 9, 10, 11, 12, 14], "fulfil": [3, 10, 12], "within": [3, 5, 9, 10, 11, 12], "predetermin": [3, 10, 12], "time": [3, 5, 9, 10, 12, 14], "interv": [3, 10, 12], "power": [3, 5, 7, 8, 9, 12, 13, 14], "sequenc": [3, 7, 8, 11, 12, 13, 14], "stop": [3, 10, 12], "intention": [3, 12], "earli": [3, 5, 12], "stage": [3, 12], "enter": [3, 10], "becom": [3, 11, 12, 14], "should": [3, 4, 11, 12, 13, 14], "avoid": [3, 12], "disrupt": [3, 12], "e": [3, 4, 11, 12], "shut": 3, "down": [3, 9], "If": [3, 4, 5, 9, 10, 12, 14], "espi": [3, 8, 10, 11, 13], "showcas": [3, 8, 13], "strap": [3, 5, 12], "doe": [3, 11, 14], "jumper": [3, 12], "directli": [3, 13], "up": [3, 9, 10, 12], "g3": [3, 13], "exit": [3, 10], "scenario": [3, 10, 11], "alon": 3, "satisfi": 3, "said": 3, "intercept": [3, 5], "dnx_force_relad": 3, "base": [3, 4, 8, 10, 12, 13], "pre": [3, 5, 10, 14], "determin": [3, 5, 6, 10, 14], "action": [3, 5, 10, 12, 14], "peripher": [3, 7, 8, 10, 11, 13, 14], "hold": 3, "volum": [3, 9, 13], "multipl": [3, 4, 7, 11, 14], "kei": [3, 5, 6, 12], "hotkei": [3, 7], "etc": [3, 8], "some": [3, 4, 5, 10, 13, 14], "constraint": [3, 12], "master": [3, 4], "attach": [3, 5, 12], "flash": 3, "sampl": [3, 5, 12], "rsmrst": 3, "signal": [3, 13], "de": [3, 10], "assert": [3, 10], "rom": 3, "bootload": 3, "prevent": [3, 12, 14], "prior": [3, 5, 10, 12], "part": [3, 4], "factor": [3, 12], "physic": [3, 10, 11, 12], "difficult": 3, "remot": 3, "session": 3, "reason": 3, "scalabl": 3, "method": [3, 11, 12], "while": [3, 4, 5, 11], "alreadi": [3, 4, 9, 10, 12], "s0": [3, 12], "sinc": [3, 4, 5, 6, 13, 14], "activ": [3, 4], "bio": [3, 8, 11, 13, 14], "propag": [3, 10], "efi": [3, 5], "blank": 3, "yet": 3, "been": [3, 4, 5, 6, 13], "program": 3, "automat": 3, "viewpoint": 3, "recover": 3, "failur": [3, 10], "howev": [3, 5, 10, 12, 13], "cannot": [3, 6, 13], "warn": [3, 11], "virtual": [3, 10, 11], "wire": [3, 5, 6, 10, 11], "reset": [3, 5, 8, 9, 10, 11, 12, 14], "follow": [3, 4, 7, 10, 11, 12, 13], "soft": 3, "whenev": [3, 9, 10, 11, 12], "global": [3, 10], "occur": [3, 9], "manual": 3, "cycl": [3, 12], "onli": [3, 4, 5, 8, 9, 11, 12, 13], "enabl": [3, 4, 5, 8, 9, 11, 13, 14], "kconfig": [3, 5, 14], "cfg": 3, "recommend": [3, 4, 12, 13], "saf": [3, 13], "ye": [3, 12, 13], "No": [3, 12, 13], "commun": [3, 5, 11, 12], "intent": [3, 12], "csme": 3, "wait": [3, 5, 10, 11], "restart": 3, "platform": [3, 8, 11, 12, 13, 14], "ifwi": 3, "sent": [3, 6, 11], "soon": [3, 12], "slave": 3, "retriev": [3, 4], "upon": [3, 11, 12], "vw": 3, "access": 3, "ack": [3, 5], "4": [3, 13], "usual": 3, "mai": [3, 4, 5, 13], "abov": [3, 4, 8, 10, 11, 13], "flag": [3, 11, 12, 13], "later": [3, 4, 6], "usag": [3, 5], "achiev": [3, 14], "pin": [3, 9, 10, 11, 12, 13], "high": [3, 9, 12, 14], "reli": [3, 10], "pseudo": [3, 13], "batteri": [3, 8, 10, 11, 14], "insert": [3, 10], "level": [3, 8, 9, 11], "shell": [3, 4, 5], "s5": 3, "button": [3, 11, 12, 13, 14], "pch_pwrok": [3, 10, 13], "ec_ds3": 3, "logic": [3, 5, 13], "dpwrok": 3, "re": [3, 4, 12], "enumer": 3, "seen": 3, "volatil": [3, 12], "save": [3, 10, 12], "persist": 3, "across": [3, 12], "gpio": [3, 9, 10], "mention": [3, 11], "instead": [3, 4, 10, 12, 13], "request": [3, 5, 11], "over": [3, 9, 10, 11], "notif": [3, 5, 10, 12], "clear": [3, 12], "v": 3, "coexist": [3, 4], "dedic": 3, "ensur": [3, 4, 12], "driven": [3, 9], "circuitri": [3, 10], "permit": [3, 14], "open": [3, 4, 8, 9, 13], "drain": [3, 13], "output": [3, 5, 10, 13], "fetch": 3, "bu": [3, 10, 11], "channel": [3, 11], "handov": 3, "first": [3, 12, 14], "abl": [3, 13], "addition": [3, 9, 13], "acknowledg": [3, 10], "develop": 4, "account": 4, "ubuntu": 4, "18": 4, "04": 4, "lt": 4, "window": [4, 5, 10, 12], "work": 4, "vpn": 4, "intranet": 4, "compani": 4, "proxi": 4, "correctli": 4, "line": [4, 9, 12], "tool": [4, 8, 12], "apt": 4, "wget": 4, "pip": 4, "git": 4, "guid": [4, 5, 10, 13], "review": 4, "consider": 4, "latest": 4, "sourc": [4, 8, 10, 13], "v3": 4, "15": 4, "simpler": [4, 14], "mandatori": 4, "present": [4, 13], "uninstal": 4, "third": [4, 11], "parti": [4, 8], "copi": 4, "kernel": [4, 14], "version": [4, 8], "dediprog": 4, "A": [4, 6, 11, 13], "compil": [4, 5], "contain": [4, 8, 13], "microchip": 4, "mec15xx": [4, 13], "mec172x": [4, 13], "arm": 4, "microcontrol": [4, 8, 11], "gnu": 4, "eabi": 4, "evb": 4, "root": 4, "folder": [4, 13], "mec": 4, "creat": [4, 12], "sandbox": 4, "ecfw": 4, "mkdir": 4, "cd": 4, "http": [4, 5], "com": [4, 5], "navig": 4, "west": [4, 8], "manifest": [4, 8], "locat": 4, "insid": 4, "init": 4, "l": 4, "list": [4, 8, 12, 13], "destin": [4, 5], "revis": [4, 8, 13], "extern": [4, 8, 12], "zephyr_fork": 4, "branch": 4, "zephyrproject": 4, "cmsi": 4, "hal": [4, 8, 13], "093de61": 4, "hal_microchip": 4, "5d079f1": 4, "directori": 4, "structur": 4, "look": 4, "____ecfw": 4, "____ecfwwork": 4, "snapshot": 4, "patch": 4, "out": [4, 9, 10, 14], "henc": [4, 5, 9, 12], "expect": [4, 5], "futur": [4, 5, 7], "thei": [4, 5, 6], "integr": 4, "assum": [4, 9, 10], "checkout": 4, "ecfwwork": 4, "am": 4, "zephyr_patch": 4, "patches_v3": [], "throw": 4, "mean": [4, 6, 8, 9], "previou": [4, 5, 10], "safe": 4, "delet": 4, "backup": 4, "exist": [4, 12], "other": [4, 5, 9, 10, 11, 12, 14], "problem": 4, "run": [4, 5, 6, 10, 12], "path": 4, "env": 4, "sh": 4, "tree": [4, 13], "zephyr_bas": 4, "script": 4, "switch": [4, 13], "auto": 4, "b": [4, 10, 13], "mec1501_adl": [], "mec1501_adl_p": [], "tgl": [4, 6, 10, 12], "deprec": 4, "alwai": [4, 12], "mec1501modular_assy6885": 4, "dconfig_mec15xx_aic_on_tgl": 4, "y": [4, 12], "similar": 4, "replac": 4, "modular": [4, 6, 13], "success": 4, "bin": 4, "ksc": [4, 5, 6], "spi_imag": 4, "give": 4, "make": [4, 14], "sure": 4, "execut": [4, 7, 10, 14], "printenv": 4, "grep": 4, "revisit": 4, "spi_gen": 4, "confirm": 4, "usr": 4, "local": 4, "everglades_spi_gen_lin64": 4, "chmod": 4, "x": [4, 12], "wa": [5, 10], "conceiv": 5, "realiz": [5, 6], "8042": 5, "spec": [5, 10, 13], "ibm": 5, "1": [5, 11, 12, 13], "core": 5, "inform": [5, 6, 8, 11], "cpu": [5, 13, 14], "manag": [5, 7, 13, 14], "auxiliari": 5, "kept": 5, "evolv": 5, "point": 5, "respons": [5, 10, 11], "than": [5, 12], "just": 5, "therefor": [5, 9], "todai": 5, "becam": 5, "subset": [5, 8], "chip": [5, 13], "modern": 5, "pc": [5, 8], "either": [5, 9, 10, 11, 14], "pictur": 5, "illustr": [5, 6], "trigger": [5, 9, 10], "here": [5, 10], "we": [5, 6, 7], "softwar": [5, 7], "entiti": 5, "show": 5, "how": [5, 11, 14], "process": [5, 9, 11, 12], "mainli": [5, 9], "fsm": 5, "direct": [5, 9, 10, 11], "3": [5, 13], "isr": [5, 11], "precis": 5, "moment": 5, "0x60": 5, "default_st": 5, "new": [5, 10], "order": [5, 8, 9, 13], "continu": [5, 6, 9], "given": 5, "kbchost": [5, 6], "two": 5, "thread": [5, 9, 10, 11, 12, 14], "input": [5, 9, 12, 13], "valu": [5, 11], "One": 5, "exclus": 5, "feed": 5, "argument": 5, "dummi": 5, "result": [5, 9], "exercis": [5, 13], "becaus": 5, "artifici": 5, "repli": 5, "maintain": 5, "remain": [5, 12], "speak": 5, "0x64": 5, "term": 5, "arriv": 5, "address": [5, 11, 13], "payload": 5, "On": [5, 9, 11], "hand": [5, 11], "wish": 5, "both": [5, 9, 11, 13], "transact": [5, 11], "complet": [5, 6, 10], "goe": 5, "context": [5, 11], "0xd4": 5, "0xf4": 5, "0xfa": 5, "0xad": 5, "0xa7": 5, "0xaa": 5, "self": 5, "test": 5, "0x55": 5, "0x67": 5, "0xed": 5, "led": 5, "0x00": 5, "turn": [5, 10], "off": [5, 10], "wherea": 5, "bear": 5, "mind": 5, "vari": 5, "drive": [5, 10], "littl": 5, "complex": 5, "finer": 5, "calibr": 5, "dictat": 5, "0x02": 5, "correspond": [5, 13], "bit": 5, "one": [5, 11], "0x20": 5, "0x77": 5, "0xae": 5, "0xa8": 5, "0x44": 5, "0x74": 5, "0xff": 5, "bat": 5, "0x04": 5, "0x34": 5, "0xf3": 5, "rate": 5, "delai": [5, 10], "id": 5, "0x47": 5, "0xf2": 5, "0xe8": 5, "resolut": 5, "0xe6": 5, "scale": 5, "0xe9": 5, "statu": [5, 10, 11], "0x03": 5, "0xc8": 5, "0x50": 5, "0x08": 5, "reus": 5, "intern": [5, 12], "leav": 5, "undisrupt": 5, "featur": [5, 12, 13], "runtim": [5, 11], "chang": [5, 9, 12], "timeout": 5, "reduc": [5, 10, 13], "modifi": [5, 11], "eas": 5, "distinct": 5, "come": [5, 10], "50m": 5, "definit": 5, "guarante": 5, "race": [5, 12], "64bito": 5, "tistori": 5, "cfile29": 5, "uf": 5, "02784b4d50f966f12c3160": 5, "pdf": 5, "compos": [6, 14], "row": 6, "column": 6, "circuit": [6, 9], "close": [6, 9, 12], "eventu": 6, "sens": 6, "map": [6, 10, 13], "treat": 6, "were": 6, "few": 6, "fake": 6, "want": 6, "let": 6, "successfulli": 6, "involv": [6, 9], "isn": 6, "t": [6, 9, 13], "ribbon": 6, "bottom": 6, "divid": 7, "plan": [7, 14], "task": [7, 8, 10, 11], "download": 7, "variou": 8, "low": [8, 9, 10], "oper": [8, 11, 12], "thermal": [8, 11, 13, 14], "lan": 8, "pcie": 8, "basic": 8, "ia": [8, 12], "oem": [8, 12], "leverag": 8, "boot": [8, 12, 13, 14], "enhanc": [8, 10], "serial": [8, 10, 13], "interfac": [8, 9, 10, 13, 14], "demonstr": 8, "3rd": 8, "common": [8, 11], "depict": [8, 11], "packag": [8, 13], "bsp": [8, 13], "abstract": [8, 13], "layer": [8, 13], "meta": 8, "yml": 8, "act": [8, 11], "find": 8, "about": [8, 11, 12, 13], "human": [9, 11, 13, 14], "associ": 9, "pull": [9, 10, 12], "interrupt": [9, 11], "laptop": [9, 10], "lid": [9, 13], "rotat": 9, "lock": 9, "notifi": [9, 11], "deal": 9, "undesir": 9, "effect": 9, "bang": 9, "togeth": 9, "caus": 9, "electr": 9, "rebound": 9, "befor": [9, 10, 11, 12, 14], "settl": 9, "transient": 9, "remov": [9, 10], "debounc": [9, 10], "cooper": [9, 10, 11, 14], "regist": [9, 10, 11, 12], "per": [9, 11], "edg": 9, "move": 9, "stabl": [9, 10], "counter": 9, "begin": 9, "increas": 9, "millisecond": 9, "reach": 9, "zero": 9, "without": [9, 12], "bounc": 9, "period": [9, 11, 14], "observ": 9, "expir": 9, "anoth": 9, "maximum": 9, "debounce_tim": 9, "won": 9, "exhibit": 9, "durat": 9, "exceed": 9, "5": 9, "too": 9, "noisi": 9, "filter": 9, "actual": [9, 13], "keep": 10, "desktop": 10, "o": [10, 11], "concept": 10, "enough": 10, "known": 10, "smc_onoff": 10, "toward": [10, 11], "pch": [10, 14], "good": 10, "rail": 10, "slp_s3": 10, "slp_s4": 10, "slp_s5": 10, "undergo": 10, "specifi": 10, "transmit": [10, 11], "gx": 10, "appli": 10, "whole": 10, "visibl": 10, "rsmrst_pwrgd": 10, "sus_wrn": 10, "sus_ack": 10, "capac": 10, "pm_batlow": 10, "slp_m": 10, "sometim": 10, "slp_a": 10, "sys_pwrok": 10, "7": [4, 10, 14], "segment": [10, 14], "displai": [10, 14], "post": [10, 14], "fan": [10, 11, 13], "ac": 10, "adaptor": 10, "reconfigur": 10, "consumpt": [10, 12], "further": 10, "lose": 10, "entri": 10, "ec_dsx": 10, "pm_slp_su": 10, "wake": 10, "rmsrst": 10, "sus_warn": 10, "regular": 10, "normal": [10, 12], "overal": 10, "10": 10, "m": 10, "again": [10, 11, 14], "To": [10, 11], "hub": 10, "relev": [10, 11], "did": 10, "Such": 10, "postcod": [10, 14], "format": 10, "ecnn": 10, "nn": 10, "aspect": 10, "smbu": 11, "share": 11, "memori": [11, 12], "chapter": 11, "12": 11, "queri": [11, 12], "obtain": 11, "domain": 11, "Or": 11, "extend": 11, "bidirect": 11, "vice": 11, "versa": 11, "figur": 11, "70": 11, "rang": 11, "ec_sc": 11, "written": 11, "ec_dat": 11, "exchang": 11, "frequent": 11, "emul": 11, "tunnel": 11, "lpc": 11, "11": 11, "nutshel": 11, "predefin": [11, 12], "0x80": 11, "0x84": 11, "0x66": 11, "0x62": 11, "traffic": 11, "ibf": 11, "free": 11, "66": 11, "outgo": 11, "3a": 11, "until": 11, "3b": 11, "62": 11, "4a": 11, "obf": 11, "incom": 11, "4b": 11, "previous": 11, "awar": 11, "issu": 11, "upcom": 11, "outsid": 11, "pattern": 11, "schedul": [11, 14], "asynchron": 11, "enqueu": 11, "implic": 11, "flush": 11, "standard": 11, "own": 11, "space": 11, "nevertheless": [11, 12], "instanc": 11, "tabl": [11, 13], "match": 11, "field": 11, "enrich": 11, "smchost_cod": 11, "flexibl": [12, 13], "odm": 12, "wdt": 12, "cabl": 12, "load": 12, "authent": 12, "collect": 12, "extract": 12, "emerg": 12, "trace": 12, "crash": 12, "log": [12, 13], "manufactur": 12, "floor": 12, "bone": 12, "pile": 12, "triag": 12, "rma": 12, "appropri": 12, "product": 12, "chassi": 12, "perturb": 12, "pmc_gpio": 12, "At": 12, "attent": 12, "paid": 12, "loop": 12, "non": [12, 13, 14], "next": 12, "amount": [12, 14], "prefer": 12, "pmc": 12, "prj_mec1501modular_assy6885": 12, "conf": 12, "config_early_key_sequence_detect": 12, "config_power_sequence_disable_timeout_hotkei": 12, "config_early_keyseq_custom0": 12, "33": 12, "item": 12, "hot": 12, "occurr": 12, "second": [12, 14], "last": 12, "alt": 12, "shift": 12, "d": 12, "ifdef": 12, "pwreq_timeout_dis": 12, "kbs_keyseq_boot_detect": 12, "keyseq_timeout": 12, "pwrseq_timeout_dis": 12, "true": 12, "log_wrn": 12, "kb": 12, "constrain": 12, "keyscan": [12, 13], "6": 12, "conjunct": 13, "take": [13, 14], "advantag": 13, "guidelin": [13, 14], "rework": 13, "meteorlak": 13, "alderlak": [], "minimum": [13, 14], "uart": 13, "timer": 13, "i2c": 13, "80": 13, "visual": 13, "acpi": 13, "critic": [13, 14], "advanc": 13, "peci": 13, "tach": 13, "adc": 13, "pwm": 13, "friendli": 13, "macro": 13, "i2c_bus_0": 13, "dt_label": [], "dt_nodelabel": 13, "i2c_smb_0": 13, "doesn": 13, "import": 13, "deleg": 13, "boardname_chipvers": 13, "ec_gpio_106": 13, "ec_gpio_036": 13, "ec_gpio_xxx": 13, "number": 13, "onboard": 13, "rout": 13, "miss": 13, "compar": 13, "schemat": 13, "discuss": 13, "adher": 13, "consist": 13, "guidanc": 13, "what": 13, "area": 13, "mtl": [4, 13], "sx": 13, "deep": 13, "sleep": [13, 14], "dsx": 13, "temperatur": 13, "ps2": 13, "mous": [13, 14], "porta": 13, "portb": 13, "though": 13, "1x5": 13, "header": 13, "mec17xx": 13, "spawn": 14, "essenti": 14, "kbc": 14, "creation": 14, "idiom": 14, "static": 14, "less": 14, "k_thread_defin": 14, "dynam": 14, "approach": 14, "termin": 14, "middl": 14, "perspect": 14, "multicor": 14, "slice": 14, "algorithm": 14, "multitask": 14, "preemptiv": 14, "voluntarili": 14, "relinquish": 14, "yield": 14, "offer": 14, "prioriti": 14, "even": 14, "never": 14, "unreadi": 14, "starvat": 14, "simplic": 14, "accord": 14, "readi": 14, "mec172x_mtl_": 4, "mec1501_mtl_p": 4, "mec172xmodular_assy6930": 4, "patches_v3_2": 4, "relat": [], "idl": [], "subsystem": [], "mayb": [], "network": [], "spend": [], "major": [], "phase": [], "goal": [], "standbi": [], "prepar": [], "lop": [], "learn": [], "call": [], "metho": [], "smchost": [], "module_": [], "lpm": [], "unrel": [], "tick": [], "tickless": [], "noth": [], "decis": [], "pm": [], "polici": [], "overview_": [], "mec152xx": [], "suspend": [], "ram": [], "lowest": [], "proce": [], "resid": [], "allot": [], "repeat": [], "best": [], "effort": [], "forc": [], "higher": [], "particular": [], "meet": [], "criteria": [], "compat": [], "name": [], "min": [], "u": [], "300000": [], "suspend_to_ram": [], "700000": [], "impli": [], "whose": [], "lower": [], "adjust": [], "config_log_process_thread_sleep_m": [], "buffer": [], "size": [], "slow": [], "chanc": [], "overflow": [], "messag": [], "discard": [], "light": [], "renam": [], "significantli": [], "poll": [], "synchron": [], "primit": [], "fulli": [], "quickli": [], "latenc": [], "incur": [], "restor": [], "optim": []}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"embed": 0, "control": [0, 3, 5, 11], "firmwar": 0, "document": 0, "ec": [1, 3, 4, 5, 7, 11, 12, 13], "fw": [1, 3, 4, 7, 13], "applic": [1, 7, 9], "note": 1, "add": 2, "custom": [2, 11, 13], "keyboard": [2, 5, 6, 12], "matrix": [2, 6, 12], "introduct": [2, 6], "overview": [2, 3, 8, 12], "how": 2, "implement": [2, 3, 6, 9, 10, 11, 14], "new": 2, "ad": 2, "build": [2, 4], "system": [2, 5, 10, 11], "map": 2, "row": 2, "column": 2, "ibm": 2, "kei": 2, "number": 2, "fn": 2, "fx": 2, "ani": 2, "support": [3, 9, 12, 13], "intel": [3, 10, 12], "download": 3, "execut": [3, 5], "dnx": 3, "function": 3, "requir": 3, "1": [3, 4], "awar": [3, 12], "timeout": [3, 10, 12], "2": [3, 4, 5], "user": 3, "trigger": 3, "assist": 3, "entri": 3, "3": [3, 4], "non": 3, "detail": 3, "relat": 3, "option": [3, 12], "featur": 3, "other": [3, 13], "consider": [3, 12], "maf": 3, "boot": 3, "when": [3, 9], "dnx_force_reload": 3, "get": 4, "start": 4, "pre": 4, "requisit": 4, "set": 4, "up": 4, "zephyr": 4, "environ": 4, "o": [4, 5], "select": 4, "instal": 4, "depend": [4, 8], "python": 4, "4": 4, "sdk": 4, "toolchain": 4, "5": 4, "soc": [4, 12, 13], "vendor": 4, "specif": [4, 10], "setup": 4, "framework": [4, 13], "code": 4, "clone": 4, "main": 4, "repositori": [4, 8], "obtain": 4, "appli": 4, "back": 4, "port": 4, "fix": 4, "troubleshoot": 4, "flash": 4, "variabl": 4, "host": 5, "theori": 5, "oper": 5, "p": 5, "initi": [5, 13], "sequenc": [5, 10], "bio": 5, "mous": 5, "hotkei": [5, 12], "refer": 5, "scan": 6, "modul": 7, "manag": [8, 9, 10, 11], "peripher": 9, "window": 9, "button": [9, 10], "switch": 9, "power": 10, "signal": 10, "input": 10, "rsmrst": 10, "_pwrgd": 10, "all_sys_pwrgd": 10, "slp_sx": 10, "transit": 10, "acpi": [10, 11], "flow": [10, 11], "g3": 10, "s0": 10, "s3": 10, "suspend": 10, "resum": 10, "s4": 10, "s5": 10, "hibern": 10, "shutdown": 10, "deep": 10, "sleep": 10, "mechan": [10, 11], "variant": 10, "across": 10, "platform": 10, "hw": [11, 13], "interfac": 11, "sw": 11, "queue": 11, "sci": 11, "notif": 11, "region": 11, "command": 11, "debug": 12, "while": 12, "i": 12, "enabl": 12, "consent": 12, "via": 12, "bootstal": 12, "gpio": [12, 13], "extens": 12, "hardwar": 13, "limit": 13, "task": 14, "handl": 14, "softwar": [], "stack": [], "low": [], "mode": [], "design": [], "kernel": []}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Embedded controller firmware documentation": [[0, "embedded-controller-firmware-documentation"]], "EC FW application notes": [[1, "ec-fw-application-notes"]], "Add custom keyboard matrix": [[2, "add-custom-keyboard-matrix"]], "Introduction": [[2, "introduction"], [6, "introduction"]], "Overview": [[2, "overview"], [8, "overview"], [12, "overview"]], "How to implement a new keyboard": [[2, "how-to-implement-a-new-keyboard"]], "Adding a new keyboard to the build system": [[2, "adding-a-new-keyboard-to-the-build-system"]], "Map row/column to IBM key numbers": [[2, "map-row-column-to-ibm-key-numbers"]], "Map FN + FX or FN + Any key": [[2, "map-fn-fx-or-fn-any-key"]], "EC support for Intel Download and Execute": [[3, "ec-support-for-intel-download-and-execute"]], "DnX overview": [[3, "dnx-overview"]], "EC functional requirements for DnX": [[3, "ec-functional-requirements-for-dnx"]], "1. EC DnX awareness and EC timeout": [[3, "ec-dnx-awareness-and-ec-timeout"]], "2. User-triggered EC-assisted DnX entry": [[3, "user-triggered-ec-assisted-dnx-entry"]], "3. Non-user triggered DnX entry": [[3, "non-user-triggered-dnx-entry"]], "Implementation details": [[3, "implementation-details"]], "EC FW DnX awareness": [[3, "ec-fw-dnx-awareness"]], "EC FW DnX-related optional features": [[3, "ec-fw-dnx-related-optional-features"]], "Other considerations": [[3, "other-considerations"]], "Supporting MAF boot when controlling DNX_FORCE_RELOAD": [[3, "supporting-maf-boot-when-controlling-dnx-force-reload"]], "Getting started": [[4, "getting-started"]], "Pre-requisites": [[4, "pre-requisites"]], "Setting Up Zephyr environment": [[4, "setting-up-zephyr-environment"]], "1) OS selection": [[4, "os-selection"]], "2) Install dependencies": [[4, "install-dependencies"]], "3) Get Zephyr and Python dependencies": [[4, "get-zephyr-and-python-dependencies"]], "4) Install Zephyr SDK and toolchain": [[4, "install-zephyr-sdk-and-toolchain"]], "5) EC SoC vendor-specific setup": [[4, "ec-soc-vendor-specific-setup"]], "Getting EC FW framework code": [[4, "getting-ec-fw-framework-code"]], "1) Clone main repository": [[4, "clone-main-repository"]], "2) Obtain the dependencies": [[4, "obtain-the-dependencies"]], "3) Apply back-ported fixes": [[4, "apply-back-ported-fixes"]], "Troubleshoot": [[4, "troubleshoot"], [4, "id2"]], "Building and flashing": [[4, "building-and-flashing"]], "1) Set zephyr environment variables": [[4, "set-zephyr-environment-variables"]], "2) Build EC FW": [[4, "build-ec-fw"]], "Flash EC FW": [[4, "flash-ec-fw"]], "Keyboard System Controller Host": [[5, "keyboard-system-controller-host"]], "Theory of operation": [[5, "theory-of-operation"]], "PS/2 keyboard initialization sequence executed in BIOS": [[5, "ps-2-keyboard-initialization-sequence-executed-in-bios"]], "PS/2 keyboard and mouse initialization sequence executed in OS": [[5, "ps-2-keyboard-and-mouse-initialization-sequence-executed-in-os"]], "EC hotkeys": [[5, "ec-hotkeys"]], "References": [[5, "references"]], "Keyboard scan matrix": [[6, "keyboard-scan-matrix"]], "Implementation": [[6, "implementation"], [9, "implementation"], [10, "implementation"], [11, "implementation"], [14, "implementation"]], "EC FW application modules": [[7, "ec-fw-application-modules"]], "Dependencies": [[8, "dependencies"]], "Repository Management": [[8, "repository-management"]], "Peripheral management": [[9, "peripheral-management"]], "Windows Button Support": [[9, "windows-button-support"]], "Switches (when applicable)": [[9, "switches-when-applicable"]], "Power Sequencing": [[10, "power-sequencing"]], "Power Signals": [[10, "power-signals"]], "Power button input": [[10, "power-button-input"]], "RSMRST#_PWRGD": [[10, "rsmrst-pwrgd"]], "ALL_SYS_PWRGD": [[10, "all-sys-pwrgd"]], "SLP_Sx#": [[10, "slp-sx"]], "System transitions": [[10, "system-transitions"]], "ACPI System Transitions": [[10, "acpi-system-transitions"]], "Flow for G3 to S0": [[10, "flow-for-g3-to-s0"]], "Flow for S0 to S3 (suspend)": [[10, "flow-for-s0-to-s3-suspend"]], "Flow for S3 to S0 (resume)": [[10, "flow-for-s3-to-s0-resume"]], "Flow for S0 to S4/S5 (hibernate/shutdown)": [[10, "flow-for-s0-to-s4-s5-hibernate-shutdown"]], "Flow for S5/S4 to S0": [[10, "flow-for-s5-s4-to-s0"]], "Intel-specific Power Management Transitions": [[10, "intel-specific-power-management-transitions"]], "Flow for S3/S4/S5 to deep sleep": [[10, "flow-for-s3-s4-s5-to-deep-sleep"]], "Flow for deep sleep to S3/S4/S5": [[10, "flow-for-deep-sleep-to-s3-s4-s5"]], "Timeout Mechanism": [[10, "timeout-mechanism"]], "Variants Across Platforms": [[10, "variants-across-platforms"]], "System Management Controller": [[11, "system-management-controller"]], "HW interface": [[11, "hw-interface"]], "SW flow": [[11, "sw-flow"]], "Queue Mechanism": [[11, "queue-mechanism"]], "SCI Notifications": [[11, "sci-notifications"]], "ACPI Region": [[11, "acpi-region"]], "Custom EC Commands": [[11, "custom-ec-commands"]], "EC support for Intel SoC Debug": [[12, "ec-support-for-intel-soc-debug"]], "SoC debug while EC timeout is enabled": [[12, "soc-debug-while-ec-timeout-is-enabled"]], "EC SoC-debug awareness": [[12, "ec-soc-debug-awareness"]], "SoC-debug consent via SoC bootstall GPIO": [[12, "soc-debug-consent-via-soc-bootstall-gpio"]], "Considerations": [[12, "considerations"], [12, "id1"]], "Optional extensions": [[12, "optional-extensions"]], "SoC-debug consent via Keyboard matrix hotkey": [[12, "soc-debug-consent-via-keyboard-matrix-hotkey"]], "Supported Hardware": [[13, "supported-hardware"]], "Other EC SoC": [[13, "other-ec-soc"]], "Customize EC FW framework for other EC SoC": [[13, "customize-ec-fw-framework-for-other-ec-soc"]], "GPIO initialization": [[13, "gpio-initialization"]], "HW limitations": [[13, "hw-limitations"]], "Task Handling": [[14, "task-handling"]]}, "indexentries": {}})